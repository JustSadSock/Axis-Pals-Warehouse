# Axis Pals: Warehouse

Кооперативная top-down головоломка про двух роботов, которые могут толкать ящики только по своей оси. Работает локально на одной клавиатуре или онлайн через WebSocket-сервер (готов к запуску за Cloudflare Tunnel).

## Запуск

### Установка зависимостей
```bash
npm ci
```

### Локальный сервер
```bash
npm run dev
```
Откройте http://localhost:3000.

### WebSocket URL
Клиент сам использует `location.host` и выбирает `ws://` или `wss://` в зависимости от протокола. Это работает и локально, и через публичный туннель.

### Батник с Cloudflare Tunnel
В Windows используйте скрипт:
```bat
run-axis-pals.bat
```
Он проверит Node/npm, поставит зависимости, запустит локальный сервер, поднимет туннель `cloudflared` и запишет адреса в `scripts/.axis-pals-tunnel.env`.

## Управление
- Игрок 1: **WASD**, толкает только влево/вправо.
- Игрок 2: **стрелки**, толкает только вверх/вниз.
- `R` или кнопка "Перезапуск уровня" — сбрасывает текущий уровень в локальном режиме.

## Локальный кооп
- При старте появляется экран выбора режима с крупными кнопками: локально (по умолчанию), онлайн и бесконечный режим.
- После выбора локального режима показывается HUD с подсказками для обоих игроков и список уровней для быстрого выбора.
- Для рестарта текущего уровня нажмите `R` или кнопку в панели.

## Бесконечный режим
- Генерирует новые уровни локально, каждый следующий немного сложнее (больше стен и ящиков).
- Перед выдачей уровня запускается проверка проходимости (поиск в ширину), чтобы не попадались безвыходные конфигурации.
- После победы автоматически загружается следующая волна.

## Структура
- `server/server.js` — Express + WebSocket (`/ws`), комната на 2 игрока, сервер — источник состояния.
- `public/` — статика (канвас-рендер, уровни, общая игровая логика, сетевой клиент).
- `run-axis-pals.bat` — быстрый запуск локального сервера и Cloudflare Tunnel.

## Логика
- `public/gameLogic.js` — единый модуль для сервера и клиента (проверки стен, движение, толкание по оси, победа).
- `public/levels.js` — 5 уровней: от обучения до узких коридоров.

Приятного кооператива!
